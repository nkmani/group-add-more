(function(b){b.fn.jquery.split(".");b.fn.group_add_more=function(f){function h(){if(0<g.length){var c=g.pop();if("obj"==c.type){var e=c.val;a.verbose&&console.log("triggering on "+b(e).attr("id"));b(e).trigger("mousedown")}else"sel"==c.type&&(c=b(c.val),0<b(c).length?(a.verbose&&console.log("triggering on "+b(c).attr("id")),b(c).trigger("mousedown")):console.log("Could not find input from "+e))}}function m(){b(a.addMoreBtnSelector,d).each(function(){var c=null,e="";switch(a.drupal){case 7:c=this;
do if(c=b(c).parent(),b(c).hasClass("form-wrapper")){e=b(c).attr("id");break}while(0==e.length);break;case 6:c=this;do c=b(c).parent(),e=b(c).attr("id");while(0==e.length)}if(0==e.length)console.log("Could not find parent for input "+this);else{var d=b(c).find(k);if(0==d.length)console.log("Could not find table with class "+k+" near add-more button");else if(c=b(d).find("tbody > tr").length,d=b(d).attr("id"),console.log(d+" "+c+" "+a.numInitRows),c<a.numInitRows)for(;c<a.numInitRows;c++)g.push({type:"sel",
val:"#"+e+" "+a.addMoreBtnSelector})}})}var d=b(this),a=b.extend({},{addMoreClass:"",groupAddMoreLabel:"Add More",groupAddMoreClass:"group-add-more",fieldTableClass:"",addMoreBtnSelector:"",drupal:7,hide:!1,initRows:!1,numInitRows:1,verbose:!1},f);f=a.groupClass+"-processed";var g=[];if(!b(d).hasClass(f)){switch(a.drupal){case 7:""==a.addMoreClass&&(a.addMoreClass="field-add-more-submit");""==a.fieldTableClass&&(a.fieldTableClass="field-multiple-table");""==a.addMoreBtnSelector&&(a.addMoreBtnSelector=
"."+a.addMoreClass);break;case 6:""==a.addMoreClass&&(a.addMoreClass="content-add-more"),""==a.fieldTableClass&&(a.fieldTableClass="content-multiple-table"),""==a.addMoreBtnSelector&&(a.addMoreBtnSelector="."+a.addMoreClass+" input")}var l="."+a.addMoreClass,n="."+a.groupAddMoreClass,k="."+a.fieldTableClass;b(d).append('<input type="submit" class="'+a.groupAddMoreClass+' button" value="'+a.groupAddMoreLabel+'" />');a.hide&&(b(l,d).hide(),b(d).bind("DOMNodeInserted",function(){b(this).find(l).hide()}));
a.initRows&&(m(),h());b(document).ajaxSuccess(function(){h()});b(n,d).click(function(){b(a.addMoreBtnSelector,d).each(function(){g.push({type:"obj",val:this})});h();return!1});b(d).addClass(f)}}})(jQuery);